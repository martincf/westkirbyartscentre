{% include header.html %}
  <h1 class="event--title"><span>{{ page.title }}</span></h1>
  <main class="content event--content">
  <div class="event--pay">
    <h1 class="event--pay-title">Book tickets</h1>
    {% if page.bookable == false %}

      <p class="event--nobooking">Tickets must be booked via the organiser:</p>
      <button class="event--organisertickets">
        <a href="{{ page.organiser_url }}">Organiser website &gt;</a>
      </button>
    {% elsif page.bookable == true %}

    <p class="event--price">&pound;{{ page.price }}</p>
    <p class="event--tickets">
      Tickets: <input type="number" id="ticketNo" value="1" class="event--ticketno" />
    </p>
    <div id="paypal-button" class="event--paypal"></div>
  <script>
      paypal.Button.render({
          env: 'sandbox', // Or 'production'
          client: {
              sandbox:    'AVosSv7HYDbBVhFmwXqq0XVzaAmjhLArJNVU70PuF9GuogeIte44yuIZYfCoWEYd250Bo30aYcJaUtLi',
              production: 'xxxxxxxxx'
          },
          style: {
              size: 'responsive',
              color: 'blue',
              shape: 'rect',
              label: 'pay',
              // fundingicons: true
          },
          commit: true, // Show a 'Pay Now' button
          payment: function(data, actions) {
            // Get value of ticket number input, multiply by price and give the total to Paypal
            ticketNos = document.getElementById("ticketNo").value;
            price = {{ page.price }}
            TicketTotal = price * ticketNos
              return actions.payment.create({
                  payment: {
                      transactions: [
                          {
                              amount: { total: TicketTotal, currency: 'GBP' },
                              description: 'The Art Centre West Kirby ticket(s) purchase',
                              item_list:
                                {
                                  items: [
                                    { name: '{{ page.title }} ticket(s)', currency: 'GBP', price: '{{ page.price }}', quantity: ticketNos }
                                  ]
                                }
                          }
                      ]
                  }
              });
          },

          onAuthorize: function(data, actions) {
              return actions.payment.execute().then(function(payment) {

                  // The payment is complete!
                  // You can now show a confirmation message to the customer
              });
          }

      }, '#paypal-button');
  </script>
  {% endif %}
</div>
  <div class="event--data">
      <!-- Get event date -->
      <p class="event--date">{{ page.date | date: '%A, %d %b %Y' }} â€“ {{ page.time }} </p>
      <p class="event--genre">{{ page.type }}</p>
  </div>
  <article  markdown="1" class="event--details">
    {{ page.content | markdownify }}
  </article>
  </main>
{% include footer.html %}
